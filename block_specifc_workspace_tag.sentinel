import "tfrun" as tfrun


# List of prohibited tags
prohibited_list = ["prod", "test"]

tags = tfrun.tags

# Call the validation function
# Warnings will be printed for violations
cost_validated = tfrun.tags != prohibited_list

violatingTags = config.filter_attribute_in_list(tags,
                     "type", prohibited_list, true)

main = rule {
 length(violatingTags["messages"]) is 0
}
